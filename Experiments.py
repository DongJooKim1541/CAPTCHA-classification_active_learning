import matplotlib.pyplot as plt
import numpy as np
from PIL import Image
import matplotlib.pyplot as plt

num_epochs = 100
def CompareByQuerySize():
    # Compare by query size
    fig = plt.figure(figsize=(12, 20))
    x = np.linspace(1, num_epochs, num_epochs)
    baseline_test_acc = [0.024216753853040198, 0.21490191379276863, 0.4381834327580808, 0.3384761990652112, 0.5319501616289056, 0.6189277759705867, 0.5804634809164452, 0.35812410549632534, 0.6401514297453424, 0.44312296934041745, 0.6333828416169963, 0.5807243970453146, 0.6385778562670901, 0.5685922394560471, 0.45461103555307, 0.6114708225915371, 0.655048054986345, 0.671982596067978, 0.6727679294877364, 0.6809593996523107, 0.21728697462509408, 0.6652336418713444, 0.6967457498151081, 0.6491328196421884, 0.6765733247871766, 0.611998686472179, 0.4128388432544592, 0.6069975731841201, 0.4368043127783823, 0.6740394244381922, 0.5370242052292866, 0.39037932203337206, 0.7003476119815802, 0.6993984835314229, 0.4497718450565057, 0.7038581234481351, 0.6610341373677586, 0.1698649902052871, 0.662071549276528, 0.3366205330356317, 0.6941740635861418, 0.6996331045540645, 0.6926487318154035, 0.34817881982935556, 0.6789822260165722, 0.7298657572315655, 0.62794605803026, 0.7209672109123723, 0.13957876559988566, 0.6824409624141486, 0.6997015816270886, 0.6938298361534112, 0.4736921408400159, 0.7010436804630452, 0.7832118713223704, 0.7864845317683979, 0.7877653933944629, 0.7893996281559171, 0.8032527833766105, 0.8043017414931776, 0.8055490328406674, 0.8067895543092456, 0.8095262824735432, 0.802055117031642, 0.8052090012510668, 0.811238523942606, 0.8026048641997785, 0.8110596865452, 0.8000394910392888, 0.808650140166525, 0.8103852941936098, 0.8110264990100161, 0.8098914614775541, 0.8035006074531653, 0.8090708615571774, 0.8083205153084101, 0.80456792586749, 0.8114789723878699, 0.8060759195557637, 0.8153423878950423, 0.8149031193753116, 0.8136284061767918, 0.8084882189334148, 0.8114791315153422, 0.8084377787051799, 0.8021068731510358, 0.8109661269588283, 0.8139102316382111, 0.8161861562487736, 0.8092969989737867, 0.8162610689914716, 0.8075898930501769, 0.8099837584075089, 0.8150613349262205, 0.8219875196272919, 0.819559185808782, 0.8115673693091863, 0.828166353457468, 0.8056770014180117, 0.8210334142763848]

    query_1000_test_acc = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00017105753288486607, 0.0009605795390959639, 0.0017969070048680735, 0.01889365790032466, 0.04944178069229751, 0.08831093867386475, 0.040973307944713634, 0.14538999825525015, 0.18910728879462152, 0.21983521537462503, 0.15086103035129983, 0.3436118508528792, 0.3444914030872069, 0.19746145237588128, 0.3653366758166784, 0.37698545977472137, 0.4382881365765105, 0.45579490900802483, 0.47443472085199717, 0.5146147067060928, 0.46196863316144443, 0.5138028572045887, 0.5190477506716307, 0.5791408782692413, 0.5524522486558403, 0.5958229505844045, 0.5776997187852315, 0.5882900008384886, 0.5754881499830734, 0.6234646584729971, 0.6454564548330184, 0.6006014430216307, 0.6287696275559879, 0.5810702844188675, 0.6167758548377521, 0.6389577482466032, 0.6523681369562104, 0.6483739708931892, 0.6558622851796638, 0.6455175844157064, 0.6504228411465826, 0.6555263657965335, 0.6387960594735522, 0.6769771630821454, 0.6453224698897705, 0.6633316939710245, 0.49955213386355707, 0.6599944524706965, 0.6598938858434514, 0.6841869616086723, 0.649932407342835, 0.6642683896083634, 0.6515669429220106, 0.6836967825859083, 0.6208726005799411, 0.6705990455943128, 0.6981340047184432, 0.6851941400049345, 0.6711047750921539, 0.6757284983434504, 0.690846022791919, 0.6608910718038461, 0.6858302076705795, 0.5872660760268996, 0.703940486991224, 0.6938940634589822, 0.47387279860183185, 0.6819148938888553, 0.6614007045754621, 0.6561947748160534, 0.686638817910742, 0.6880023557154474, 0.6895471799144489, 0.7038270400453311, 0.6864653832941724, 0.6621181716261874, 0.6903617588923375, 0.7037713031515064, 0.7207023710667544, 0.6804432597142098, 0.5548997121716558, 0.1205582932606118, 0.6892529777019848, 0.6545591395151441, 0.38297189220480676, 0.6814996009103426, 0.6929625867967838, 0.6893349544054179, 0.05415023445069502, 0.6834812526271743, 0.6832068727362809, 0.7868034681544895, 0.790458458583905, 0.7956046873458859]

    query_2000_test_acc = [0.0, 0.0, 2.772935226310771e-05, 0.00045495513265981065, 0.0005334425449556675, 0.013359716261083756, 0.051341013851925056, 0.07883332489553264, 0.05699206199859269, 0.1627031107603898, 0.2192315833478107, 0.2626367561873875, 0.34410073253050644, 0.3555438235973201, 0.44169574411540263, 0.43028876798560944, 0.4913157572290074, 0.5238972592372413, 0.5181519797899038, 0.5467193268005078, 0.5859799424603346, 0.5932578492682192, 0.5649665696439128, 0.590197046987245, 0.6019040527928113, 0.6320683874063306, 0.6254844497167983, 0.2830923084486904, 0.611965679700421, 0.6476332556113187, 0.5927729447992988, 0.684978652088658, 0.5174178697010636, 0.6251247953844269, 0.6643124984422125, 0.6536808712015214, 0.6743285228256195, 0.6389376307832529, 0.6851913873570784, 0.6450809944412907, 0.6106065027989718, 0.6917700130900571, 0.6597876042450755, 0.6396154003760594, 0.6472623508729237, 0.7091918617158479, 0.6577611595614988, 0.6803289078806278, 0.6756079675940877, 0.6919894231696966, 0.6783893324129477, 0.6177091577932324, 0.6846532110718381, 0.6881456597456586, 0.6628353787998764, 0.6949351587905299, 0.6573695900090755, 0.7134668129792772, 0.6704898715239898, 0.6773481517348817, 0.6723567311798868, 0.6657916297321974, 0.6835718029553702, 0.701903365592896, 0.7027932338287335, 0.6954455280985748, 0.7143850969041717, 0.7118470620024221, 0.6799960608808613, 0.7048943864719783, 0.6747085524096434, 0.7118512636795988, 0.6731804621489019, 0.48934188383003163, 0.6359433901609951, 0.7219756370363628, 0.6576400273913457, 0.7080047415634142, 0.698893452627973, 0.6800287586316516, 0.7142461238863719, 0.7118077058978955, 0.44638794758662165, 0.6999251721874707, 0.7152808513938146, 0.6546299458768678, 0.3462798819121106, 0.7163485721553414, 0.47159341966665225, 0.7192873501515583, 0.7780094483482936, 0.7923777758182979, 0.7922172437398097, 0.7939333369729158, 0.7993126895326516, 0.800852555092369, 0.8017575270310251, 0.805646932571864, 0.8047460462330562, 0.8048406362541687]

    query_5000_test_acc = [0.0, 0.0, 0.0008824180311434985, 0.03374751842395363, 0.08250359643941847, 0.20360071522632286, 0.33179742993263456, 0.37927783453773456, 0.44679699630921865, 0.4928897542066955, 0.5025567961018065, 0.4669715184591339, 0.5147567298729935, 0.49922714533639934, 0.6066499609262785, 0.595458745858557, 0.6055907901850612, 0.6001459913492445, 0.6373716616491089, 0.6523099277642017, 0.6541588595835428, 0.6494154341006838, 0.5195869339350612, 0.5706975626220637, 0.6587537787846498, 0.6877283069054332, 0.39485781975927164, 0.6867680457062237, 0.6615084749403543, 0.4578674447739909, 0.6905032853190125, 0.6741698185994834, 0.5609032957370119, 0.6795409086662333, 0.6536504765104546, 0.6800432552808762, 0.689858173213075, 0.662271799964194, 0.6968406051796847, 0.6730577690366891, 0.6885700469623173, 0.7043055512469906, 0.6386115022131279, 0.6904961915945846, 0.7096581199845083, 0.6791943140331501, 0.6202207895203067, 0.5258403567248945, 0.6864709923401221, 0.7167359821695571, 0.5903129888717056, 0.6828043191299905, 0.6906722505641248, 0.706020936442934, 0.7247945031882176, 0.4189695259886749, 0.6974801044054263, 0.7110129751990999, 0.6596841884727023, 0.7024373939029961, 0.6587891394258056, 0.5405826900512785, 0.6313241202595734, 0.6940620225307358, 0.6943863271692258, 0.7267987598358379, 0.6925930690932964, 0.5983998756133347, 0.659967967839209, 0.686576094843019, 0.7311918662559895, 0.7024288315980773, 0.5965134796258659, 0.7841401067365558, 0.7870412116909871, 0.7947342273109398, 0.7907852690701072, 0.7954531501751152, 0.8040618840777797, 0.7974023600935047, 0.8026058688732695, 0.7937207052418559, 0.8010206226100189, 0.8017264587406305, 0.8098544047846123, 0.8069333609492022, 0.8100189429414858, 0.8109440407142039, 0.806770722254824, 0.8080494430697722, 0.8103984496354809, 0.8063391175794449, 0.8068983841134432, 0.8020392868602862, 0.8070710264684656, 0.8072497521461607, 0.808116672563822, 0.8113690922272067, 0.812234522100301, 0.8124073323173505]

    baseline_test_loss = [2.310548298847601, 1.2437310563111157, 0.6127550492745749, 0.9760379756089324, 0.5359507200325498, 0.29029033416361544, 0.3476129872088107, 0.9734843930472499, 0.2742633037963269, 0.7549541951706691, 0.3208243287405612, 0.40893945246009356, 0.26270747189381105, 0.40995388764957463, 0.8010428572848717, 0.3033229698490652, 0.2779181264803646, 0.24234950343459288, 0.22330633666574584, 0.21197615110355875, 1.513889759964084, 0.27166963234451247, 0.209736065950638, 0.25466847845486235, 0.22736724038024125, 0.2756555639901517, 0.834122704052777, 0.34806889971220717, 0.7803015112876892, 0.264111120184386, 0.47168953980533235, 1.0817544965640358, 0.16894070649091503, 0.1868927949426337, 0.9064802797684758, 0.19094880094161684, 0.24147274379867203, 1.771389461081961, 0.26720903364953047, 1.1508683873259502, 0.18127241471539374, 0.20343735557257758, 0.20595031437573966, 1.3707604652606182, 0.21981880064151302, 0.1562299558788723, 0.36829911898937284, 0.15610342986465242, 1.8923333450133757, 0.2241140227556599, 0.19834793622819533, 0.22029224887305165, 0.7799934278363767, 0.22748163203645197, 0.09248922016726148, 0.08387577997647827, 0.07921191645635767, 0.07764597574353033, 0.07518328740753187, 0.06998219939168565, 0.07128783204934057, 0.06806406036296987, 0.0662234476565019, 0.06799924526918934, 0.07193118565201019, 0.06437626618729986, 0.07074220104848747, 0.06462371809211392, 0.07387052376910766, 0.06997073965829721, 0.06826725064181023, 0.06705401323573745, 0.06818056030210501, 0.06948992600722342, 0.06574916506984405, 0.06857174943253305, 0.07630741210966747, 0.06510596954905838, 0.07369266525026619, 0.06872442066206695, 0.0647108353940504, 0.06763842257075244, 0.06949978665975125, 0.06622746434664319, 0.07298159848620987, 0.08070936084071302, 0.06779364407386469, 0.07003627049950709, 0.07082677339290425, 0.07477831758952104, 0.06575483510629361, 0.09642080344282877, 0.07241710542660693, 0.07603032464705269, 0.06394294793977871, 0.07223710225119909, 0.07455626956146696, 0.07097954343518485, 0.09590844416076907, 0.07327654308159344]
    query_1000_test_loss = [3.6752966316590396, 3.5897114676718385, 3.5990843039862117, 3.59142806219018, 3.624747894565511, 3.51827435389809, 3.3694547214863464, 3.156700903584498, 3.1957830220275785, 2.5616651862304405, 2.2392682781130633, 1.824787159884198, 2.142488437779942, 1.4314753161454052, 1.3165161143178525, 1.2162441670524409, 1.5026807996056835, 0.8035040784696614, 0.7529964500702686, 1.415761617399891, 0.8731662421863272, 0.6123284182008009, 0.4712738807527175, 0.5068386384048817, 0.5334916986663889, 0.4183702260626029, 0.5419991014536863, 0.514589013427681, 0.41772725090662144, 0.3720091241672172, 0.42381280197860294, 0.326237550016886, 0.3274405053035813, 0.3561409923785962, 0.3493823507650298, 0.25147985056135225, 0.252159447866197, 0.30567729949766065, 0.30480063732088725, 0.37181613464718277, 0.3296717640405856, 0.2846125532751498, 0.2232558070132451, 0.2473980239737108, 0.2061077470873824, 0.26192087911485884, 0.26149403206680133, 0.2389037320101113, 0.3050125230404531, 0.19063692576951863, 0.22785474387755306, 0.21705719685147268, 0.48407043359294444, 0.21994894458362774, 0.2295202466179125, 0.20104923610639128, 0.22424923468913352, 0.2396918237672089, 0.19810746991949052, 0.2190391007602585, 0.2901597123893892, 0.23680136537885074, 0.18832122020839903, 0.2033354754079573, 0.2308836184580874, 0.22991069049938864, 0.18979800318986734, 0.225110974162817, 0.17646674844233887, 0.3942418740310284, 0.1794951441495315, 0.18941639942226943, 0.6861437888619322, 0.20296606025803163, 0.23526253833533814, 0.27590317545192583, 0.18721606302427948, 0.17791893182796722, 0.19016511560134267, 0.18606659545568946, 0.2083351536891105, 0.21338396931286924, 0.19268294326637103, 0.20974503376561662, 0.16119725784714917, 0.20892348376490313, 0.4120916645997059, 1.7346926213051221, 0.18811394959132863, 0.20696868941835736, 0.8088566564625095, 0.18693372412868167, 0.17270185240769978, 0.18816194171953646, 2.1413437476069292, 0.20876847603213713, 0.22270100797462908, 0.0796607976073619, 0.0783972122897365, 0.07141110221190113]

    query_2000_test_loss = [3.6466192495748864, 3.6077362632159122, 3.5764713509482626, 3.502452139528642, 3.200056458852306, 2.710537817167199, 2.2159933762520736, 1.693973385769388, 1.1717474566113135, 1.0400502368900346, 1.084966032956698, 0.6785655191966465, 0.6287571535162304, 0.6615785209473616, 0.4485565448954979, 0.5497991001198751, 0.4818140256293812, 0.3297834954461696, 0.346435141257988, 0.3668196081004528, 0.35916643835002593, 0.4608711858528741, 0.44951973577834065, 0.33739104978046064, 0.39085573684539854, 0.2754928147107918, 0.3303438336675211, 0.25716941172014113, 0.7133639882440153, 0.2299471168969729, 0.2517241036854916, 0.4354076407710958, 0.2375720955477738, 0.24205310330350208, 0.24654807807495877, 0.2860074087236979, 0.211693231918797, 0.311273136771984, 3.011785214732152, 0.21574424709314885, 0.8798919856918525, 0.27803149606500355, 0.19858005101451223, 0.20389426680085082, 0.18568837871740324, 0.23632243016491766, 0.24385814637130832, 0.37820409418818374, 0.20451018119358128, 0.2678009669140259, 0.26528044947370977, 0.3056560528250585, 1.3952091054886764, 0.2144669746713979, 0.20729367633969148, 0.20406632900515698, 0.3368384483160439, 0.17215573776119986, 1.153618978417438, 0.1693233619241611, 0.1785309970702814, 1.1617176092189292, 0.18072270444646385, 0.23954818969280084, 0.29410512657454296, 0.15165261603799296, 0.1573818987293273, 0.24823194489993664, 0.26360162798754916, 0.23874936447195386, 0.5983634742890825, 0.1712796580486046, 0.19315787226609563, 0.16374559924932, 0.09035956050321367, 0.08270088688510915, 0.0762269952687325, 0.07170042863566868, 0.07414052958212654, 0.0772858796560246, 0.07025411839579573, 0.07008808479291496, 0.0774791534261211, 0.0691918835495107, 0.06654733004661635, 0.07146245703355682, 0.06488460135177611, 0.06441529408698866, 0.06418825014962913, 0.06406328745579683, 0.06277232908105813, 0.06547585845294392, 0.07215575391415113, 0.06350532346491858, 0.06462269886657133, 0.06527229972322535, 0.06377939299697646, 0.07302290757377602, 0.06757021499855548, 0.06603554017286493]
    query_5000_test_loss = [3.597682331659779, 3.5998461002148456, 3.265131443924045, 2.2572322147233144, 1.7671914459755702, 0.987919053861073, 0.6871847648242986, 0.5884200840818216, 0.46505587978392654, 0.4877516270054053, 0.466808896349824, 0.49395079938521297, 0.4277889096403714, 0.5358406175737795, 0.30659347573607604, 0.3030540652526832, 0.2727993117726367, 0.3187849936740739, 0.22942105227190515, 0.23362874572876818, 0.2520826549865074, 0.26186402308644713, 0.42718567435415633, 0.3475154843297064, 0.22632388728931083, 0.1920005755024667, 0.7434950867054625, 0.19936367501475796, 0.2616895431224604, 0.6746027648263837, 0.2032333665429065, 0.24484138678967582, 0.4043383839893045, 0.18684895625858575, 0.25980012433499283, 0.1946791027504835, 0.2143516211498598, 0.24355992253707803, 0.19046287046548743, 0.22254045296067038, 0.22219501329319818, 0.16920159775648058, 0.2541961470931213, 0.21065997070870043, 0.17955697397267598, 0.19671190150591158, 0.25585244882921254, 0.44237465559510714, 0.22465116491321452, 0.16091703859545428, 0.3481574400056223, 0.2548122998350155, 0.19173652597743532, 0.1918904451850038, 0.16896801064751163, 0.7351214094376712, 0.17612522583663093, 0.17149352770506965, 0.24688856715556257, 0.20600384719068218, 0.21733562844973173, 0.4319074019234373, 0.2875161383370435, 0.20593980866374437, 0.22209797019821517, 0.1665617667879007, 0.22280311073112932, 0.36909997060617306, 0.2470486916555381, 0.20838325586378204, 0.15985451358723343, 0.1862098806948395, 0.34703656360044244, 0.09133128974563587, 0.08171235935427017, 0.0801336286728334, 0.0780791005304789, 0.07422490802634021, 0.07263997456880275, 0.07444606528195165, 0.06818469682627398, 0.07583796241037223, 0.07003273111507759, 0.06666753734953655, 0.07094929437297656, 0.06443702737852838, 0.0660527526019199, 0.06675848162947048, 0.06825373707026798, 0.06607594579365683, 0.06731781635942481, 0.06475896609264502, 0.06723507275654478, 0.06854718002079992, 0.06701978415782962, 0.06521220559034474, 0.06762137705957667, 0.0688739525796325, 0.06699474376875052, 0.06477216860823194]

    ax1 = fig.add_subplot(2, 1, 1)
    ax1.set_title("Compare test accuracy by query size(pool size=5000, strategy=margin)")
    ax1.plot(x, baseline_test_acc, label="baseline")
    ax1.plot(x, query_1000_test_acc, label="query 1000")
    ax1.plot(x, query_2000_test_acc, label="query 2000")
    ax1.plot(x, query_5000_test_acc, label="query 5000")
    ax1.set_xlabel("Epochs")
    ax1.set_ylabel("Accuracy")
    ax1.legend()

    ax2 = fig.add_subplot(2, 1, 2)
    ax2.set_title("Compare test loss by query size(pool size=5000, strategy=margin)")
    ax2.plot(x, baseline_test_loss, label="baseline")
    ax2.plot(x, query_1000_test_loss, label="query 1000")
    ax2.plot(x, query_2000_test_loss, label="query 2000")
    ax2.plot(x, query_5000_test_loss, label="query 5000")
    ax2.set_xlabel("Epochs")
    ax2.set_ylabel("Loss")
    ax2.legend()

    plt.show()

def CompareByPoolSize():
    # Compare by pool size
    fig = plt.figure(figsize=(12, 20))
    x = np.linspace(1, num_epochs, num_epochs)
    baseline_test_acc = [0.024216753853040198, 0.21490191379276863, 0.4381834327580808, 0.3384761990652112, 0.5319501616289056, 0.6189277759705867, 0.5804634809164452, 0.35812410549632534, 0.6401514297453424, 0.44312296934041745, 0.6333828416169963, 0.5807243970453146, 0.6385778562670901, 0.5685922394560471, 0.45461103555307, 0.6114708225915371, 0.655048054986345, 0.671982596067978, 0.6727679294877364, 0.6809593996523107, 0.21728697462509408, 0.6652336418713444, 0.6967457498151081, 0.6491328196421884, 0.6765733247871766, 0.611998686472179, 0.4128388432544592, 0.6069975731841201, 0.4368043127783823, 0.6740394244381922, 0.5370242052292866, 0.39037932203337206, 0.7003476119815802, 0.6993984835314229, 0.4497718450565057, 0.7038581234481351, 0.6610341373677586, 0.1698649902052871, 0.662071549276528, 0.3366205330356317, 0.6941740635861418, 0.6996331045540645, 0.6926487318154035, 0.34817881982935556, 0.6789822260165722, 0.7298657572315655, 0.62794605803026, 0.7209672109123723, 0.13957876559988566, 0.6824409624141486, 0.6997015816270886, 0.6938298361534112, 0.4736921408400159, 0.7010436804630452, 0.7832118713223704, 0.7864845317683979, 0.7877653933944629, 0.7893996281559171, 0.8032527833766105, 0.8043017414931776, 0.8055490328406674, 0.8067895543092456, 0.8095262824735432, 0.802055117031642, 0.8052090012510668, 0.811238523942606, 0.8026048641997785, 0.8110596865452, 0.8000394910392888, 0.808650140166525, 0.8103852941936098, 0.8110264990100161, 0.8098914614775541, 0.8035006074531653, 0.8090708615571774, 0.8083205153084101, 0.80456792586749, 0.8114789723878699, 0.8060759195557637, 0.8153423878950423, 0.8149031193753116, 0.8136284061767918, 0.8084882189334148, 0.8114791315153422, 0.8084377787051799, 0.8021068731510358, 0.8109661269588283, 0.8139102316382111, 0.8161861562487736, 0.8092969989737867, 0.8162610689914716, 0.8075898930501769, 0.8099837584075089, 0.8150613349262205, 0.8219875196272919, 0.819559185808782, 0.8115673693091863, 0.828166353457468, 0.8056770014180117, 0.8210334142763848]

    pool_1000_test_acc =  [0.0, 0.0, 1.914048590242708e-05, 0.0015916965120818414, 0.009110089870853395, 0.025400156501006348, 0.05212981936377154, 0.1050305159384673, 0.12096125319132756, 0.16753633284042815, 0.24617706665523245, 0.3287383832325616, 0.36770048581184006, 0.3849793291355537, 0.3720119963523974, 0.41898159179450245, 0.4798638615364626, 0.5040324780682145, 0.5214023401068796, 0.48950514747651885, 0.43336593841658005, 0.5344919180696263, 0.43237799393059545, 0.5999083344221846, 0.5771740690414534, 0.5836828720242462, 0.3203477230991371, 0.6098642454530234, 0.5019167311824854, 0.5912965665363761, 0.48327892540034306, 0.5297444582409987, 0.5970684260064759, 0.634410921210072, 0.6047609802587873, 0.6187718576442199, 0.6208447007866205, 0.5730596680082563, 0.6356225437834727, 0.6517253521957513, 0.653429157396142, 0.6651973614279703, 0.25719373566026743, 0.34806000096645406, 0.6155756511567242, 0.6554165021968751, 0.6418388554548949, 0.680309246396158, 0.531011442369549, 0.6925652136687043, 0.6347245704742914, 0.648567472550932, 0.6203274298457362, 0.679994041453218, 0.694681456855532, 0.6475207517998742, 0.6285962844460925, 0.7649991358688417, 0.7711699947459313, 0.7832670754267432, 0.7833823572212162, 0.7848375779543055, 0.7878075446271323, 0.7937726553294889, 0.7949571978623243, 0.7951088729273872, 0.7982387594091688, 0.7935389383849233, 0.7980920682790407, 0.8009215674861563, 0.8039949399918549, 0.8016630272042855, 0.8020933808864679, 0.8039238848913107, 0.8017065005652428, 0.803523431231449, 0.8048902725223128, 0.804556223608895, 0.80213924853497, 0.8042079582999675, 0.8057733820955935, 0.805933731967868, 0.8061674983895758, 0.8084688042205961, 0.8053593282560786, 0.7983833045900638, 0.808133465799129, 0.8089024033922831, 0.8008178818114822, 0.8072005507355517, 0.803226069202387, 0.8126877106316353, 0.8105250191430717, 0.8047898595288464, 0.8048918605196982, 0.811622445013154, 0.8041361192115651, 0.807205059163462, 0.8127607710841849, 0.8089268979949071]
    pool_2000_test_acc = [0.0, 0.0, 0.0, 0.0014166909114773723, 0.01263995572830987, 0.020810045146122832, 0.06381245109162731, 0.0813889461645188, 0.12564485382710816, 0.18918637398232424, 0.18516774841223574, 0.27250967986765273, 0.3171904762269658, 0.3054805318553274, 0.39204419301902194, 0.4193727409057457, 0.4250404225225347, 0.4423602271397611, 0.44092629763155305, 0.4973536410036976, 0.4606399164439967, 0.4373681490201028, 0.5002239619352679, 0.5223090685950158, 0.5143057602098381, 0.5990657216973043, 0.5503217876533013, 0.5734694166027697, 0.5870478502662522, 0.6007861296965649, 0.6228800171603639, 0.5864116211011049, 0.5926752147589891, 0.6294681154459824, 0.6134710646457303, 0.6169747261030096, 0.6562748558841554, 0.6355262294724522, 0.6298971694558514, 0.6172316122897554, 0.28876018591350433, 0.6549244270225687, 0.6505844130807493, 0.6284775021865041, 0.6678828295110917, 0.6518833657835177, 0.6532198280153693, 0.6655123092877838, 0.66613816534526, 0.6652174205849285, 0.7074370471779328, 0.6755682890257261, 0.10345135584872425, 0.6836000127888069, 0.6355022407469694, 0.7111132438175289, 0.5777393721259552, 0.7135564741795647, 0.7092935569248733, 0.6926647129509359, 0.7124919118240932, 0.6925618262274048, 0.6864707374199894, 0.6898797485604122, 0.6986252521820994, 0.7086091771493913, 0.7075702423844884, 0.6777773640771734, 0.6972661780803193, 0.6127922256596401, 0.04437062125980974, 0.6721736337684695, 0.060201288920289905, 0.6504571197902462, 0.6775925883979791, 0.6774213947210547, 0.7016173683888695, 0.7068781055816553, 0.6831737083454174, 0.6789723392792876, 0.7313911927874397, 0.7330731205889208, 0.5032730229190292, 0.7291551288903921, 0.7329859097927929, 0.6886817953841495, 0.7388154600176071, 0.7602093306151465, 0.7442018388438475, 0.7309790189307406, 0.6807217991389432, 0.7017761578395144, 0.7172132017370325, 0.737308929944867, 0.7211899638654833, 0.6351881585792061, 0.6933293557946687, 0.6852919302174804, 0.7094066686767284, 0.7091172692885386]

    pool_5000_test_acc = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00017105753288486607, 0.0009605795390959639, 0.0017969070048680735, 0.01889365790032466, 0.04944178069229751, 0.08831093867386475, 0.040973307944713634, 0.14538999825525015, 0.18910728879462152, 0.21983521537462503, 0.15086103035129983, 0.3436118508528792, 0.3444914030872069, 0.19746145237588128, 0.3653366758166784, 0.37698545977472137, 0.4382881365765105, 0.45579490900802483, 0.47443472085199717, 0.5146147067060928, 0.46196863316144443, 0.5138028572045887, 0.5190477506716307, 0.5791408782692413, 0.5524522486558403, 0.5958229505844045, 0.5776997187852315, 0.5882900008384886, 0.5754881499830734, 0.6234646584729971, 0.6454564548330184, 0.6006014430216307, 0.6287696275559879, 0.5810702844188675, 0.6167758548377521, 0.6389577482466032, 0.6523681369562104, 0.6483739708931892, 0.6558622851796638, 0.6455175844157064, 0.6504228411465826, 0.6555263657965335, 0.6387960594735522, 0.6769771630821454, 0.6453224698897705, 0.6633316939710245, 0.49955213386355707, 0.6599944524706965, 0.6598938858434514, 0.6841869616086723, 0.649932407342835, 0.6642683896083634, 0.6515669429220106, 0.6836967825859083, 0.6208726005799411, 0.6705990455943128, 0.6981340047184432, 0.6851941400049345, 0.6711047750921539, 0.6757284983434504, 0.690846022791919, 0.6608910718038461, 0.6858302076705795, 0.5872660760268996, 0.703940486991224, 0.6938940634589822, 0.47387279860183185, 0.6819148938888553, 0.6614007045754621, 0.6561947748160534, 0.686638817910742, 0.6880023557154474, 0.6895471799144489, 0.7038270400453311, 0.6864653832941724, 0.6621181716261874, 0.6903617588923375, 0.7037713031515064, 0.7207023710667544, 0.6804432597142098, 0.5548997121716558, 0.1205582932606118, 0.6892529777019848, 0.6545591395151441, 0.38297189220480676, 0.6814996009103426, 0.6929625867967838, 0.6893349544054179, 0.05415023445069502, 0.6834812526271743, 0.6832068727362809, 0.7868034681544895, 0.790458458583905, 0.7956046873458859]

    baseline_test_loss = [2.310548298847601, 1.2437310563111157, 0.6127550492745749, 0.9760379756089324, 0.5359507200325498, 0.29029033416361544, 0.3476129872088107, 0.9734843930472499, 0.2742633037963269, 0.7549541951706691, 0.3208243287405612, 0.40893945246009356, 0.26270747189381105, 0.40995388764957463, 0.8010428572848717, 0.3033229698490652, 0.2779181264803646, 0.24234950343459288, 0.22330633666574584, 0.21197615110355875, 1.513889759964084, 0.27166963234451247, 0.209736065950638, 0.25466847845486235, 0.22736724038024125, 0.2756555639901517, 0.834122704052777, 0.34806889971220717, 0.7803015112876892, 0.264111120184386, 0.47168953980533235, 1.0817544965640358, 0.16894070649091503, 0.1868927949426337, 0.9064802797684758, 0.19094880094161684, 0.24147274379867203, 1.771389461081961, 0.26720903364953047, 1.1508683873259502, 0.18127241471539374, 0.20343735557257758, 0.20595031437573966, 1.3707604652606182, 0.21981880064151302, 0.1562299558788723, 0.36829911898937284, 0.15610342986465242, 1.8923333450133757, 0.2241140227556599, 0.19834793622819533, 0.22029224887305165, 0.7799934278363767, 0.22748163203645197, 0.09248922016726148, 0.08387577997647827, 0.07921191645635767, 0.07764597574353033, 0.07518328740753187, 0.06998219939168565, 0.07128783204934057, 0.06806406036296987, 0.0662234476565019, 0.06799924526918934, 0.07193118565201019, 0.06437626618729986, 0.07074220104848747, 0.06462371809211392, 0.07387052376910766, 0.06997073965829721, 0.06826725064181023, 0.06705401323573745, 0.06818056030210501, 0.06948992600722342, 0.06574916506984405, 0.06857174943253305, 0.07630741210966747, 0.06510596954905838, 0.07369266525026619, 0.06872442066206695, 0.0647108353940504, 0.06763842257075244, 0.06949978665975125, 0.06622746434664319, 0.07298159848620987, 0.08070936084071302, 0.06779364407386469, 0.07003627049950709, 0.07082677339290425, 0.07477831758952104, 0.06575483510629361, 0.09642080344282877, 0.07241710542660693, 0.07603032464705269, 0.06394294793977871, 0.07223710225119909, 0.07455626956146696, 0.07097954343518485, 0.09590844416076907, 0.07327654308159344]

    pool_1000_test_loss = [3.6752966316590396, 3.5897114676718385, 3.5990843039862117, 3.59142806219018, 3.624747894565511, 3.51827435389809, 3.3694547214863464, 3.156700903584498, 3.1957830220275785, 2.5616651862304405, 2.2392682781130633, 1.824787159884198, 2.142488437779942, 1.4314753161454052, 1.3165161143178525, 1.2162441670524409, 1.5026807996056835, 0.8035040784696614, 0.7529964500702686, 1.415761617399891, 0.8731662421863272, 0.6123284182008009, 0.4712738807527175, 0.5068386384048817, 0.5334916986663889, 0.4183702260626029, 0.5419991014536863, 0.514589013427681, 0.41772725090662144, 0.3720091241672172, 0.42381280197860294, 0.326237550016886, 0.3274405053035813, 0.3561409923785962, 0.3493823507650298, 0.25147985056135225, 0.252159447866197, 0.30567729949766065, 0.30480063732088725, 0.37181613464718277, 0.3296717640405856, 0.2846125532751498, 0.2232558070132451, 0.2473980239737108, 0.2061077470873824, 0.26192087911485884, 0.26149403206680133, 0.2389037320101113, 0.3050125230404531, 0.19063692576951863, 0.22785474387755306, 0.21705719685147268, 0.48407043359294444, 0.21994894458362774, 0.2295202466179125, 0.20104923610639128, 0.22424923468913352, 0.2396918237672089, 0.19810746991949052, 0.2190391007602585, 0.2901597123893892, 0.23680136537885074, 0.18832122020839903, 0.2033354754079573, 0.2308836184580874, 0.22991069049938864, 0.18979800318986734, 0.225110974162817, 0.17646674844233887, 0.3942418740310284, 0.1794951441495315, 0.18941639942226943, 0.6861437888619322, 0.20296606025803163, 0.23526253833533814, 0.27590317545192583, 0.18721606302427948, 0.17791893182796722, 0.19016511560134267, 0.18606659545568946, 0.2083351536891105, 0.21338396931286924, 0.19268294326637103, 0.20974503376561662, 0.16119725784714917, 0.20892348376490313, 0.4120916645997059, 1.7346926213051221, 0.18811394959132863, 0.20696868941835736, 0.8088566564625095, 0.18693372412868167, 0.17270185240769978, 0.18816194171953646, 2.1413437476069292, 0.20876847603213713, 0.22270100797462908, 0.0796607976073619, 0.0783972122897365, 0.07141110221190113]
    pool_2000_test_loss = [3.6274035524877704, 3.604128225989964, 3.5102405770224814, 3.1633755294432553, 2.6434032309869804, 2.348372539378101, 1.7520133678957541, 1.6433128040769827, 1.2459493283159244, 1.072045433965529, 1.0745465305651196, 0.7950694747963307, 0.8136930043652931, 0.8381217490442051, 0.5800606045663727, 0.6262189365506913, 0.5863021891679823, 0.5741707016222225, 0.6159025630595522, 0.453516197500762, 0.5108673583646739, 0.6154916744609797, 0.5453376791306904, 0.41227748203351633, 0.4818136622631772, 0.29213602729835864, 0.39870363422987626, 0.38515341240241663, 0.306554709115754, 0.2848077388653844, 0.2749591300854031, 0.38277652628303316, 0.3129975234407075, 0.2449885155334606, 0.25429277420506713, 0.29048260139382404, 0.22403143353251195, 0.24834352620640157, 0.26894529267960454, 0.3251089517559324, 1.1296867443167644, 0.2465022439542024, 0.2759801651472631, 0.2726864470458179, 0.2435172491284631, 0.2559699718811497, 0.24360702274748997, 0.2091240509650352, 0.24749794688006366, 0.24744018729521622, 0.17480273556357584, 0.26649250090122223, 1.8685739092204883, 0.21515524706670217, 0.3219765865747233, 0.17459365609825028, 0.34473191988394125, 0.19079832582277542, 0.1932346898345103, 0.25979622330817376, 0.17874382542712347, 0.19669904585302986, 0.1946543809142172, 0.21024212828889396, 0.1841031987891064, 0.22082977478178392, 0.23373673027901917, 0.2169101346075905, 0.2847451727767909, 0.3753074840266512, 2.7065343142296214, 0.2649830383775027, 2.345834337406277, 0.30852527643397726, 0.2391028178404577, 0.2727136800516836, 0.20908406436998653, 0.2199544870751615, 0.22212439798605368, 0.23910900096623053, 0.18268629940955536, 0.17105264286076802, 0.6904805571951481, 0.17768235495371848, 0.1573829235659438, 0.20882714255163387, 0.15571215917697603, 0.14418718896759963, 0.14167470702473423, 0.189352103179286, 0.26140314979212625, 0.1851912761419456, 0.1668608177985464, 0.15162220631974824, 0.2222143692999893, 0.2859876502004469, 0.20006295212584993, 0.2219237381858485, 0.1774356288615591, 0.1918392235077686]

    pool_5000_test_loss = [3.597682331659779, 3.5998461002148456, 3.265131443924045, 2.2572322147233144, 1.7671914459755702, 0.987919053861073, 0.6871847648242986, 0.5884200840818216, 0.46505587978392654, 0.4877516270054053, 0.466808896349824, 0.49395079938521297, 0.4277889096403714, 0.5358406175737795, 0.30659347573607604, 0.3030540652526832, 0.2727993117726367, 0.3187849936740739, 0.22942105227190515, 0.23362874572876818, 0.2520826549865074, 0.26186402308644713, 0.42718567435415633, 0.3475154843297064, 0.22632388728931083, 0.1920005755024667, 0.7434950867054625, 0.19936367501475796, 0.2616895431224604, 0.6746027648263837, 0.2032333665429065, 0.24484138678967582, 0.4043383839893045, 0.18684895625858575, 0.25980012433499283, 0.1946791027504835, 0.2143516211498598, 0.24355992253707803, 0.19046287046548743, 0.22254045296067038, 0.22219501329319818, 0.16920159775648058, 0.2541961470931213, 0.21065997070870043, 0.17955697397267598, 0.19671190150591158, 0.25585244882921254, 0.44237465559510714, 0.22465116491321452, 0.16091703859545428, 0.3481574400056223, 0.2548122998350155, 0.19173652597743532, 0.1918904451850038, 0.16896801064751163, 0.7351214094376712, 0.17612522583663093, 0.17149352770506965, 0.24688856715556257, 0.20600384719068218, 0.21733562844973173, 0.4319074019234373, 0.2875161383370435, 0.20593980866374437, 0.22209797019821517, 0.1665617667879007, 0.22280311073112932, 0.36909997060617306, 0.2470486916555381, 0.20838325586378204, 0.15985451358723343, 0.1862098806948395, 0.34703656360044244, 0.09133128974563587, 0.08171235935427017, 0.0801336286728334, 0.0780791005304789, 0.07422490802634021, 0.07263997456880275, 0.07444606528195165, 0.06818469682627398, 0.07583796241037223, 0.07003273111507759, 0.06666753734953655, 0.07094929437297656, 0.06443702737852838, 0.0660527526019199, 0.06675848162947048, 0.06825373707026798, 0.06607594579365683, 0.06731781635942481, 0.06475896609264502, 0.06723507275654478, 0.06854718002079992, 0.06701978415782962, 0.06521220559034474, 0.06762137705957667, 0.0688739525796325, 0.06699474376875052, 0.06477216860823194]
    ax1 = fig.add_subplot(2, 1, 1)
    ax1.set_title("Compare test accuracy by pool(query size=1000, strategy=margin)")
    ax1.plot(x, baseline_test_acc, label="baseline")
    ax1.plot(x, pool_1000_test_acc, label="pool 1000")
    ax1.plot(x, pool_2000_test_acc, label="pool 2000")
    ax1.plot(x, pool_5000_test_acc, label="pool 5000")
    ax1.set_xlabel("Epochs")
    ax1.set_ylabel("Accuracy")
    ax1.legend()

    ax2 = fig.add_subplot(2, 1, 2)
    ax2.set_title("Compare test loss by pool(query size=1000, strategy=margin)")
    ax2.plot(x, baseline_test_loss, label="baseline")
    ax2.plot(x, pool_1000_test_loss, label="pool 1000")
    ax2.plot(x, pool_2000_test_loss, label="pool 2000")
    ax2.plot(x, pool_5000_test_loss, label="pool 5000")
    ax2.set_xlabel("Epochs")
    ax2.set_ylabel("Loss")
    ax2.legend()

    plt.show()

def CompareByQuery():
    # Compare by queries
    fig = plt.figure(figsize=(12, 20))
    x = np.linspace(1, num_epochs, num_epochs)
    baseline_test_acc = [0.024216753853040198, 0.21490191379276863, 0.4381834327580808, 0.3384761990652112, 0.5319501616289056, 0.6189277759705867, 0.5804634809164452, 0.35812410549632534, 0.6401514297453424, 0.44312296934041745, 0.6333828416169963, 0.5807243970453146, 0.6385778562670901, 0.5685922394560471, 0.45461103555307, 0.6114708225915371, 0.655048054986345, 0.671982596067978, 0.6727679294877364, 0.6809593996523107, 0.21728697462509408, 0.6652336418713444, 0.6967457498151081, 0.6491328196421884, 0.6765733247871766, 0.611998686472179, 0.4128388432544592, 0.6069975731841201, 0.4368043127783823, 0.6740394244381922, 0.5370242052292866, 0.39037932203337206, 0.7003476119815802, 0.6993984835314229, 0.4497718450565057, 0.7038581234481351, 0.6610341373677586, 0.1698649902052871, 0.662071549276528, 0.3366205330356317, 0.6941740635861418, 0.6996331045540645, 0.6926487318154035, 0.34817881982935556, 0.6789822260165722, 0.7298657572315655, 0.62794605803026, 0.7209672109123723, 0.13957876559988566, 0.6824409624141486, 0.6997015816270886, 0.6938298361534112, 0.4736921408400159, 0.7010436804630452, 0.7832118713223704, 0.7864845317683979, 0.7877653933944629, 0.7893996281559171, 0.8032527833766105, 0.8043017414931776, 0.8055490328406674, 0.8067895543092456, 0.8095262824735432, 0.802055117031642, 0.8052090012510668, 0.811238523942606, 0.8026048641997785, 0.8110596865452, 0.8000394910392888, 0.808650140166525, 0.8103852941936098, 0.8110264990100161, 0.8098914614775541, 0.8035006074531653, 0.8090708615571774, 0.8083205153084101, 0.80456792586749, 0.8114789723878699, 0.8060759195557637, 0.8153423878950423, 0.8149031193753116, 0.8136284061767918, 0.8084882189334148, 0.8114791315153422, 0.8084377787051799, 0.8021068731510358, 0.8109661269588283, 0.8139102316382111, 0.8161861562487736, 0.8092969989737867, 0.8162610689914716, 0.8075898930501769, 0.8099837584075089, 0.8150613349262205, 0.8219875196272919, 0.819559185808782, 0.8115673693091863, 0.828166353457468, 0.8056770014180117, 0.8210334142763848]

    margin_test_acc = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00043982141359326284, 0.004043457426718957, 0.006749121353261422,
                       0.028166573620615157, 0.027632612550720113, 0.08715401960104247, 0.09194617366654363,
                       0.13599155036423685, 0.15286193237991175, 0.22120867168389524, 0.28993374179774345,
                       0.30320951010964425, 0.27382053914900695, 0.4063697259007896, 0.3568501619099487,
                       0.41735714398431734, 0.42553349384480965, 0.4398395846219453, 0.4650602002344076,
                       0.5045379125722077, 0.49357688157220453, 0.34943791147738684, 0.438211181085343,
                       0.5383348171507376, 0.5105112266766887, 0.41171998428229684, 0.5247788698926065,
                       0.5396246856940826, 0.5930642259754784, 0.5486016417228744, 0.5388311751174591,
                       0.514501600975048, 0.6279015608764856, 0.5917081328112671, 0.6275840501138245,
                       0.5921868728489654, 0.6377575529792472, 0.6498965314600356, 0.6169621606943936,
                       0.6083935826455613, 0.6516033240505974, 0.647726086779496, 0.6088780691634862, 0.619714375524054,
                       0.6578268375842479, 0.6272902307645644, 0.6585229712247722, 0.6380045738600661,
                       0.6789169967010668, 0.5919046313828584, 0.6914438299273759, 0.6614843220540374,
                       0.6868091275662477, 0.6736466178098399, 0.6634248123164392, 0.6482045705938458,
                       0.6507246294060832, 0.6679255004625361, 0.698983523469773, 0.7033406319648684,
                       0.47129050708151754, 0.3166750737172523, 0.7042930912961383, 0.676117604644184,
                       0.6361878830580636, 0.6682584372551933, 0.7033108475747628, 0.5960507055099107, 0.68299355519043,
                       0.6689108424516766, 0.34722994874477303, 0.5876076909400975, 0.662228055525136,
                       0.6648464513544171, 0.7085322646737281, 0.6890811534411279, 0.6918829692362028,
                       0.6539874727763396, 0.6217346308243008, 0.6946927453081506, 0.7278482814847848,
                       0.6813281615107794, 0.6898905791392088, 0.7099638091060319, 0.6827450617363674,
                       0.7106283316404929, 0.5312987892971939, 0.6890885009441318, 0.6933068744628728,
                       0.7194606930629827, 0.8025158795353865, 0.8113810822756693, 0.808141888563754,
                       0.8101906527910042]
    entropy_test_acc = [0.0, 0.0, 0.000441934123273468, 0.02813210113128693, 0.08402426158413023, 0.17913769874395313,
                        0.3565690377090585, 0.4484484825090751, 0.3198273131264009, 0.4265143889753945,
                        0.4142707333366415, 0.47975024565770474, 0.5453465076393732, 0.569667487023919,
                        0.5857181351952756, 0.5972907032087065, 0.6441820363850816, 0.6025946565539774,
                        0.5995430360232672, 0.6453536386457276, 0.6189564772490826, 0.6041202913660951,
                        0.6267114424964936, 0.6579797574097747, 0.6484498976665958, 0.6874253279259227,
                        0.6165010068093872, 0.6590760473263125, 0.6600182555488937, 0.6517641984219685,
                        0.6537685728099211, 0.5082994062830029, 0.6858859431248256, 0.6074653165286706,
                        0.6831250206757208, 0.6869305041142706, 0.6926295514330341, 0.6807350917842578,
                        0.6273902469715337, 0.6609556565031288, 0.6265537553160018, 0.6608731027089114,
                        0.6673816404695867, 0.6614760588437034, 0.6770209556618618, 0.65079156162694,
                        0.6543908650684851, 0.6763183459804241, 0.7057781036081341, 0.7075379673876437,
                        0.698648454386392, 0.698131431999236, 0.684575198240073, 0.7116531158962535, 0.7032249606629573,
                        0.7002380469000496, 0.6534893102235342, 0.6888904014463242, 0.704791977456156,
                        0.6593235973668342, 0.7175773498664765, 0.7078433318929434, 0.7383580873461011,
                        0.7109558073776132, 0.796627120234453, 0.7930654545697717, 0.8114687995494253,
                        0.8033131070411501, 0.815305932966031, 0.8091048207253302, 0.8084675552936164,
                        0.8164930106191896, 0.8064227359400002, 0.812593517760515, 0.8272855439438965,
                        0.8249113586807297, 0.8162042219962571, 0.8007820933957712, 0.8174023611012495,
                        0.8245952478101538, 0.828050144928673, 0.8186539213927906, 0.817596996914898,
                        0.8243826111251691, 0.8147414117024266, 0.8120284730480073, 0.8196434981039188,
                        0.8137661655969705, 0.8218476229013927, 0.8131456459099434, 0.8203015495440886,
                        0.8161771169662421, 0.8201201612006954, 0.8089648142099897, 0.8161690122962589,
                        0.8191968031942344, 0.8174762536646872, 0.8216947334191292, 0.8144944513097726,
                        0.8260560627731554]
    least_confidence_test_acc = [0.0, 0.0, 2.578542404842445e-05, 0.01006922876872631, 0.015538702122917143,
                                 0.06039881485713658, 0.27295630659751974, 0.004263792457048589, 0.4097728781643338,
                                 0.42912946628593956, 0.5174804004235561, 0.5403208445487334, 0.24592482382924474,
                                 0.5448916786577195, 0.5940942985161443, 0.5755422089384661, 0.60696223167478,
                                 0.624280611016856, 0.3418093761392383, 0.6558749306841674, 0.5540264234954084,
                                 0.6438507690838713, 0.6143574456059789, 0.4341810464823051, 0.5363776124364239,
                                 0.6423779880804436, 0.47230804243878205, 0.6515768388932002, 0.6074574506091754,
                                 0.6363850214025076, 0.35981438564937807, 0.6296711589855926, 0.6564399785092392,
                                 0.6524602852861598, 0.697458508384632, 0.6526635085800089, 0.6622944770475323,
                                 0.7086686269515358, 0.6972152053094357, 0.675486258301005, 0.5950418173528572,
                                 0.6325067723320259, 0.6625972324290851, 0.6767302977758941, 0.5414145029227544,
                                 0.7092179583722592, 0.6304277027069424, 0.6997481707195012, 0.6575202928455922,
                                 0.6603414473744104, 0.6348871287213618, 0.5725032945583358, 0.6956124165742501,
                                 0.32840772695356146, 0.5840806607870003, 0.7212422839523982, 0.7778153258856912,
                                 0.781284042851861, 0.7904909959050489, 0.7869055747891989, 0.7898444310307341,
                                 0.7926652037385449, 0.7899536897888031, 0.788120030519758, 0.794412129699139,
                                 0.793765733119925, 0.7956083867063731, 0.796745884046589, 0.7975019219280924,
                                 0.8007720958010045, 0.8059298333854839, 0.8063345144216493, 0.8028434073470185,
                                 0.7949949863238601, 0.797661316435028, 0.7937766694169442, 0.8065623091517741,
                                 0.8024341898920035, 0.7943041074172452, 0.7989457664270737, 0.8017324439372104,
                                 0.7954096270457278, 0.806603725197311, 0.801233437913146, 0.8051799259293554,
                                 0.7969367151175851, 0.7993762331350553, 0.8012077993404364, 0.8003510477927055,
                                 0.8020563885621396, 0.8036897007722584, 0.7993955765123338, 0.8025191517001035,
                                 0.8058296084691425, 0.8001725352644454, 0.8067931104670779, 0.7995327601136626,
                                 0.7986833133124818, 0.7974525782886159, 0.8061345073179436]

    baseline_test_loss = [2.310548298847601, 1.2437310563111157, 0.6127550492745749, 0.9760379756089324, 0.5359507200325498, 0.29029033416361544, 0.3476129872088107, 0.9734843930472499, 0.2742633037963269, 0.7549541951706691, 0.3208243287405612, 0.40893945246009356, 0.26270747189381105, 0.40995388764957463, 0.8010428572848717, 0.3033229698490652, 0.2779181264803646, 0.24234950343459288, 0.22330633666574584, 0.21197615110355875, 1.513889759964084, 0.27166963234451247, 0.209736065950638, 0.25466847845486235, 0.22736724038024125, 0.2756555639901517, 0.834122704052777, 0.34806889971220717, 0.7803015112876892, 0.264111120184386, 0.47168953980533235, 1.0817544965640358, 0.16894070649091503, 0.1868927949426337, 0.9064802797684758, 0.19094880094161684, 0.24147274379867203, 1.771389461081961, 0.26720903364953047, 1.1508683873259502, 0.18127241471539374, 0.20343735557257758, 0.20595031437573966, 1.3707604652606182, 0.21981880064151302, 0.1562299558788723, 0.36829911898937284, 0.15610342986465242, 1.8923333450133757, 0.2241140227556599, 0.19834793622819533, 0.22029224887305165, 0.7799934278363767, 0.22748163203645197, 0.09248922016726148, 0.08387577997647827, 0.07921191645635767, 0.07764597574353033, 0.07518328740753187, 0.06998219939168565, 0.07128783204934057, 0.06806406036296987, 0.0662234476565019, 0.06799924526918934, 0.07193118565201019, 0.06437626618729986, 0.07074220104848747, 0.06462371809211392, 0.07387052376910766, 0.06997073965829721, 0.06826725064181023, 0.06705401323573745, 0.06818056030210501, 0.06948992600722342, 0.06574916506984405, 0.06857174943253305, 0.07630741210966747, 0.06510596954905838, 0.07369266525026619, 0.06872442066206695, 0.0647108353940504, 0.06763842257075244, 0.06949978665975125, 0.06622746434664319, 0.07298159848620987, 0.08070936084071302, 0.06779364407386469, 0.07003627049950709, 0.07082677339290425, 0.07477831758952104, 0.06575483510629361, 0.09642080344282877, 0.07241710542660693, 0.07603032464705269, 0.06394294793977871, 0.07223710225119909, 0.07455626956146696, 0.07097954343518485, 0.09590844416076907, 0.07327654308159344]

    margin_test_loss = [3.6317876784697822, 3.5807671524723124, 3.6051344145899233, 3.6080243809623007,
                        3.589260844710451, 3.5136682987213135, 3.303181893336847, 3.0504442868025405,
                        2.7612901252249014, 2.290900394783257, 2.3665920388624535, 1.723791211288168,
                        1.7520109118882172, 1.378242784035132, 1.2443628942374116, 1.0969748106432258,
                        0.7548132884946669, 0.8160755699095519, 1.0039656010473736, 0.5844096469212763,
                        0.6243407488424585, 0.5999319773653279, 0.6153878828753596, 0.6080398812242176,
                        0.5545774423372671, 0.46649337694141435, 0.4810699374409196, 0.6335384956798198,
                        0.6606498456889798, 0.37412286295283653, 0.47651570193145587, 0.8352992443934731,
                        0.4320514574184181, 0.48346450406572095, 0.2952871031087378, 0.3931260949336224,
                        0.4138086143857944, 0.5997927000989085, 0.2832494724703872, 0.40122596049530906,
                        0.25827296971349245, 0.30946089799359716, 0.2629856097031824, 0.2411246086407152,
                        0.29812325828749203, 0.30157346000767643, 0.252947559638053, 0.31547628229726915,
                        0.2866433882472678, 0.3661707691987109, 0.23974700734852264, 0.27843203955555557,
                        0.2273912115589432, 0.27497299175177303, 0.20929931872379706, 0.3409268738505263,
                        0.2160733286869822, 0.23184673987930607, 0.2388976491200998, 0.3048815612929948,
                        0.31690751289173685, 0.34574352811027015, 0.2505228570344285, 0.24640835944262351,
                        0.19245858636239302, 0.18814925372785662, 0.758438731942858, 1.0288218707771775,
                        0.187912910737051, 0.3042993881039738, 0.3432447788600596, 0.22814429713332135,
                        0.1959697016925545, 0.39029161858817807, 0.23495738215235448, 0.3052880337797337,
                        0.9730078043034358, 0.47238349396249524, 0.2311335807168706, 0.28649580265794483,
                        0.17893915945050878, 0.223429787742055, 0.22380756672402347, 0.3880887318009175,
                        0.32117163963754725, 0.2370123049209577, 0.16488248137583644, 0.20370778580259832,
                        0.24997107874347557, 0.19483845764250488, 0.21494417459420537, 0.19053358383337904,
                        0.5410674243054775, 0.24766386844078947, 0.2419462838204381, 0.19321073052583274,
                        0.09560773727593955, 0.08965419309202188, 0.07864562912572244, 0.08063343368609499]
    entropy_test_loss = [3.5781611418872146, 3.5718215763198664, 3.1802134684153964, 2.41778640569367,
                         1.9661368675853894, 1.2577989023664724, 0.7982324069331151, 0.6233221944074453,
                         1.0149384129861867, 0.6573313811550969, 0.670531625610701, 0.5103411002558951,
                         0.3722902640052464, 0.3802055527704843, 0.34246158590598136, 0.3170027401043762,
                         0.25127352825047805, 0.32713380455970764, 0.3476335680262643, 0.2756572375941721,
                         0.28468671931613304, 0.33281593529148873, 0.3197418381893857, 0.2456609823318742,
                         0.29449179588082414, 0.20583933705221052, 0.3383303511401881, 0.24245281975646937,
                         0.2397725974550899, 0.24467059821815965, 0.2514215204749048, 0.5389734761129995,
                         0.20837604353979508, 0.3378332089748442, 0.2521368683957905, 0.20374100539625062,
                         0.17263575414230364, 0.23135705942415302, 0.32190964431125924, 0.24656881452162074,
                         0.283512661731021, 0.23335399983092125, 0.23915794399214088, 0.26810633349492685,
                         0.2588672512991828, 0.22013290640637742, 0.267046634616874, 0.24745756838910327,
                         0.19212906155156792, 0.1974714358123193, 0.2223676644635867, 0.21374369817583458,
                         0.20282575592213536, 0.17183629566838282, 0.18500811862325447, 0.20416775572559107,
                         0.27533618851292946, 0.19152412931463733, 0.20363303301682384, 0.2769331979733076,
                         0.20495888352486658, 0.20096550162256874, 0.15816501613636935, 0.19035679872454322,
                         0.09981098104707943, 0.09362229753447615, 0.08402397557051841, 0.08342084544276969,
                         0.08048892940354088, 0.07796268423105249, 0.0763585958340616, 0.07399058925068897,
                         0.07782186813050916, 0.07578977037174917, 0.06774892272161585, 0.06567297392287609,
                         0.07126101678503412, 0.07574738611276291, 0.06975213553964721, 0.06670033978009075,
                         0.06626789164237724, 0.06804133041744462, 0.07003054684548644, 0.06957846253485599,
                         0.07680205211783789, 0.07034331819285518, 0.07269439188566823, 0.07678547792819253,
                         0.07441956672516668, 0.06793243310743978, 0.0682915526887645, 0.07933162409025504,
                         0.07875532978532478, 0.07807577300458128, 0.07985169552150906, 0.07880813759167372,
                         0.07111095371569351, 0.0745635327148419, 0.07493394822379724, 0.07343267380427684]
    least_confidence_test_loss = [3.576852500808905, 3.5968814229372867, 3.4758245841316553, 2.63168608253787,
                                  2.4910804869965735, 2.239749010675442, 0.8961769074016477, 3.47011064964792,
                                  0.48743052614031374, 0.6275386769579064, 0.4276720782429535, 0.40831002060856136,
                                  1.2874514129221069, 0.42952686608393, 0.31535062855630186, 0.3600065860411395,
                                  0.4135241742644991, 0.2816958653723231, 0.9155224848608052, 0.2335196939869697,
                                  0.42272030372427116, 0.24731607772178532, 0.26566126581674776, 0.646427611756769,
                                  0.4674738788549204, 0.25183279192225533, 0.57782155571517, 0.25348194732521634,
                                  0.2903761949552142, 0.2520915486196183, 0.9035222141639047, 0.2939240845464031,
                                  0.231294417256339, 0.2479942277166414, 0.18646258749761938, 0.2954296857026053,
                                  0.24606862539275093, 0.16139775861679398, 0.18375623233107305, 0.22209902804182924,
                                  0.3251383295803337, 0.26819957737226663, 0.22261380665698408, 0.2445188187155294,
                                  0.3823810720480747, 0.159641329523014, 0.2485473430628732, 0.18787807904137588,
                                  0.2326704002916813, 0.24018488164921725, 0.2544598150651277, 0.4234487524036295,
                                  0.19763122549893694, 0.9164014071781442, 0.3491030307660192, 0.15938429515924513,
                                  0.09273481208206334, 0.08846960882569507, 0.07816731162161006, 0.082000238514326,
                                  0.07400410787219772, 0.08217307852338189, 0.075665645197219, 0.08228748941342838,
                                  0.07339459823108978, 0.07574477845004626, 0.0711593547060808, 0.06895144009002432,
                                  0.06929589374141293, 0.06848158421839431, 0.06885626083760528, 0.06898577965981101,
                                  0.07074783146612762, 0.08186997848661234, 0.07730083483392777, 0.06832752086407279,
                                  0.0706185200309485, 0.06925571121576225, 0.07514444307094405, 0.07506622398353141,
                                  0.06829894306311696, 0.07591491821366622, 0.07038571050980631, 0.0721401757566455,
                                  0.06797188561502265, 0.0694604049616071, 0.07442283641361858, 0.06910690262636042,
                                  0.07245941386089562, 0.0687687382946566, 0.07147597273383637, 0.07850940993506901,
                                  0.07640562871158678, 0.0706808272205432, 0.07742570252128825, 0.07195637307147154,
                                  0.07293323467931022, 0.07233696733456776, 0.07736755518809608, 0.07052746488602821]
    ax1 = fig.add_subplot(2, 1, 1)
    ax1.set_title("Compare test accuracy by query(query size=5000, pool size=5000)")
    ax1.plot(x, baseline_test_acc, label="baseline")
    ax1.plot(x, margin_test_acc, label="margin")
    ax1.plot(x, entropy_test_acc, label="entropy")
    ax1.plot(x, least_confidence_test_acc, label="least_confidence")
    ax1.set_xlabel("Epochs")
    ax1.set_ylabel("Accuracy")
    ax1.legend()

    ax2 = fig.add_subplot(2, 1, 2)
    ax2.set_title("Compare test loss by query(query size=5000, pool size=5000)")
    ax2.plot(x, baseline_test_loss, label="baseline")
    ax2.plot(x, margin_test_loss, label="margin")
    ax2.plot(x, entropy_test_loss, label="entropy")
    ax2.plot(x, least_confidence_test_loss, label="least_confidence")
    ax2.set_xlabel("Epochs")
    ax2.set_ylabel("Loss")
    ax2.legend()

    plt.show()

#      .
if __name__ == '__main__':
    CompareByQuerySize()
    CompareByPoolSize()
    CompareByQuery()